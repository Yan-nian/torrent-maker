# 队列批量删除功能实施计划 v2.0.6

## 任务背景
用户反馈队列删除功能存在问题：输入范围 `1-12` 时提示无效数字，需要增强输入解析功能支持批量删除。

## 当前问题
1. `_remove_queue_task_interactive` 函数只支持单个数字输入
2. 用户期望批量删除但代码将范围输入视为无效
3. 12个等待任务需逐个删除，用户体验较差

## 实施方案
**方案1：增强输入解析功能**
- 支持范围输入（如 `1-12`、`1,3,5`、`1-5,8,10-12`）
- 支持批量删除确认
- 保持向后兼容性

## 详细实施步骤

### 步骤1：创建输入解析函数
**文件**：`torrent_maker.py`
**函数**：`_parse_task_selection`（新增）
**位置**：在 `_remove_queue_task_interactive` 函数前
**逻辑概要**：
- 解析单个数字：`5`
- 解析范围：`1-12` → `[1,2,3,...,12]`
- 解析混合：`1,3,5-8` → `[1,3,5,6,7,8]`
- 验证数字范围有效性
- 返回解析后的索引列表
**预期结果**：返回有效的任务索引列表或错误信息

### 步骤2：增强删除确认逻辑
**文件**：`torrent_maker.py`
**函数**：`_confirm_batch_deletion`（新增）
**位置**：在 `_remove_queue_task_interactive` 函数前
**逻辑概要**：
- 显示将要删除的任务列表
- 特别提示正在运行的任务
- 批量确认机制
- 支持取消操作
**预期结果**：用户确认后返回True，否则返回False

### 步骤3：重构主删除函数
**文件**：`torrent_maker.py`
**函数**：`_remove_queue_task_interactive`（修改）
**位置**：第5952行
**逻辑概要**：
- 集成新的输入解析功能
- 支持单个和批量删除
- 优化用户提示信息
- 增加操作统计反馈
**预期结果**：支持多种输入格式的删除操作

### 步骤4：创建测试脚本
**文件**：`test_batch_delete.py`（新建）
**逻辑概要**：
- 测试输入解析函数的各种情况
- 模拟批量删除场景
- 验证边界条件处理
**预期结果**：确保功能正常工作

### 步骤5：更新版本号
**文件**：`torrent_maker.py`
**位置**：版本号定义处
**操作**：更新到 v2.0.6
**预期结果**：版本号正确更新

## 输入格式支持
1. **单个数字**：`5` - 删除第5个任务
2. **范围**：`1-12` - 删除第1到12个任务
3. **列表**：`1,3,5` - 删除第1、3、5个任务
4. **混合**：`1-3,5,8-10` - 删除第1-3、5、8-10个任务
5. **全部**：`all` 或 `*` - 删除所有任务
6. **取消**：`0` 或 `cancel` - 取消操作

## 用户体验优化
1. **清晰提示**：显示支持的输入格式
2. **预览确认**：显示将要删除的任务列表
3. **进度反馈**：显示删除进度和结果统计
4. **错误处理**：友好的错误提示和重试机制

## 风险评估
- **低风险**：向后兼容，不影响现有功能
- **测试充分**：独立测试脚本验证
- **回滚简单**：修改集中在单个函数

## 预期效果
- 支持批量删除，提升操作效率
- 保持单个删除的兼容性
- 改善用户体验和操作反馈
- 减少重复操作，节省时间